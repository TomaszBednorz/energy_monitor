/***********************************************************************************************************
 ********************************************* Included files **********************************************
 ***********************************************************************************************************/

#include "hal_uart.h"
#include "hal_uart_cfg.h"

/***********************************************************************************************************
 ************************************************* Defines *************************************************
 ***********************************************************************************************************/

/***********************************************************************************************************
 *********************************************** Data types ************************************************
 ***********************************************************************************************************/

typedef enum
{
    Hal_Uart_Uninitialized = 0,
    Hal_Uart_Ready,
    Hal_Uart_Busy
}Hal_Uart_Status_t;

/***********************************************************************************************************
 **************************************** Local function prototypes ****************************************
 ***********************************************************************************************************/

/***********************************************************************************************************
 ******************************************** Exported objects *********************************************
 ***********************************************************************************************************/

/***********************************************************************************************************
 ********************************************* Local objects ***********************************************
 ***********************************************************************************************************/

Hal_Uart_Status_t Hal_Uart_Status;

/***********************************************************************************************************
 ******************************************* Exported functions ********************************************
 ***********************************************************************************************************/

/*!	
 * \brief Uart initialization function
 *
 * \param[in] None
 * 
 * \retval None
 */
void Hal_Uart_Init(void)
{
    Hal_Uart_Status = Hal_Uart_Ready;
}

/*!	
 * \brief Uart transmission function
 *
 * \param[in] data Buffer pointer for transmission data
 * \param[in] size Size of data to transmit
 * 
 * \retval Status code
 */
uint8_t Hal_Uart_Write(uint8_t* data, uint16_t size)
{
    uint8_t ret_val = HAL_UART_CODE_OK;

    if(Hal_Uart_Status == Hal_Uart_Ready)
    {
        Hal_Uart_Status = Hal_Uart_Busy;
        Hal_Uart_Transmit(data, size);
    }
    else
    {
        ret_val = HAL_UART_CODE_NOT_OK;
    }

    return ret_val;
}

/*!	
 * \brief Uart write complete callback - should be called from ISR
 *
 * \param[in] None
 * 
 * \retval None
 */
void Hal_Uart_WriteCb(void)
{
    if(Hal_Uart_Status == Hal_Uart_Busy)
    {
        Hal_Uart_Status = Hal_Uart_Ready;
    }
}

/***********************************************************************************************************
 ******************************************** Local functions **********************************************
 ***********************************************************************************************************/
